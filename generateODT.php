<?php
//echo "Created Document .ODT";

if ($scriptStarted === 1) 
{
//Include variables and other derp because derp
//include 'variables.php';
$odtTextStart = '<text:p text:style-name="P3">';
$odtTextEnd = '</text:p>';
$odtTextNewlineHard = '<text:line-break/>'; //Tag is <NL>
$odtNewLine = '<text:p text:style-name="P3"/></text:p>'; // Tag is <NL>

$odtTitleStart = '<text:p text:style-name="P4">'; //Tag is <TITLE> 
$odtTitleEnd = '</text:p>';//Tag is </TITLE> 

$odtSubtitleStart = '<text:p text:style-name="P5">';
$odtSubtitleEnd = '</text:p>';

$odtH1Start = '<text:p text:style-name="P8">';
$odtH1End = '</text:p>';

$odtH2Start = '<text:p text:style-name="P9">';
$odtH2End = '</text:p>';

$odtH3Start = '<text:p text:style-name="P9">';
$odtH3End = '</text:p>';

$closeDocument = '</office:text></office:body></office:document-content>';




//echo " Result of Code Snippet " . $modifiedTextAreaText ;





//Skriv all möjlig data
//$txt = '<text:p text:style-name="P4">' . $modifiedTextAreaText . '</text:p>';
//fwrite($tempFile, $txt);

if($generateDocumentsDocumentInfo['VB'] == "gen") 
{//Skriv verksamhetsberättelse

//Create TextFile because I fucking hate XML
$tempFile = fopen("coolXML.txt", "w") or die("Error creating file!");

//Put in Opening of file
$txt = '<?xml version="1.0" encoding="UTF-8"?>';
fwrite($tempFile, $txt);
//$txt = '<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="http://www.w3.org/TR/css3-text/" office:version="1.2">';
//fwrite($tempFile, $txt);
//$txt = '<office:scripts/><office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="Helvetica" svg:font-family="Helvetica" style:font-family-generic="swiss"/><style:font-face style:name="BorisBlackBloxx1" svg:font-family="BorisBlackBloxx" style:font-pitch="variable"/><style:font-face style:name="BorisBlackBloxx" svg:font-family="BorisBlackBloxx" style:font-adornments="Standard" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-adornments="Normal" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans1" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-adornments="Roman" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial Unicode MS" svg:font-family="&apos;Arial Unicode MS&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:paragraph-properties fo:text-align="justify" style:justify-single-word="false" style:text-autospace="none"><style:tab-stops><style:tab-stop style:position="16.99cm" style:type="right"/></style:tab-stops></style:paragraph-properties><style:text-properties fo:color="#000000" style:text-outline="false" style:text-position="0% 100%" style:font-name="Helvetica" fo:font-size="9pt" fo:letter-spacing="normal" fo:font-style="italic" style:text-underline-style="none" style:letter-kerning="false" style:font-name-asian="Helvetica" style:font-size-asian="9pt" style:font-style-asian="italic" style:font-name-complex="Helvetica" style:font-size-complex="9pt" style:font-style-complex="italic"/></style:style><style:style style:name="P2" style:family="paragraph" style:parent-style-name="Footer"><style:paragraph-properties fo:text-align="end" style:justify-single-word="false"/></style:style><style:style style:name="P3" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P4" style:family="paragraph" style:parent-style-name="Title"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P5" style:family="paragraph" style:parent-style-name="Subtitle"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P6" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P7" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00135968" officeooo:paragraph-rsid="00135968"/></style:style><style:style style:name="P8" style:family="paragraph" style:parent-style-name="Heading_20_1"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P9" style:family="paragraph" style:parent-style-name="Heading_20_2"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P10" style:family="paragraph" style:parent-style-name="Heading_20_3"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:run-through="background" style:wrap="run-through" style:number-wrapped-paragraphs="no-limit" style:vertical-pos="from-top" style:vertical-rel="paragraph" style:horizontal-pos="from-left" style:horizontal-rel="paragraph" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls>';
//fwrite($tempFile, $txt);
$txt = '<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="http://www.w3.org/TR/css3-text/" office:version="1.2"><office:scripts/><office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="Helvetica" svg:font-family="Helvetica" style:font-family-generic="swiss"/><style:font-face style:name="BorisBlackBloxx1" svg:font-family="BorisBlackBloxx" style:font-pitch="variable"/><style:font-face style:name="BorisBlackBloxx" svg:font-family="BorisBlackBloxx" style:font-adornments="Standard" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-adornments="Normal" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans1" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-adornments="Roman" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial Unicode MS" svg:font-family="&apos;Arial Unicode MS&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:paragraph-properties fo:text-align="justify" style:justify-single-word="false" style:text-autospace="none"><style:tab-stops><style:tab-stop style:position="16.99cm" style:type="right"/></style:tab-stops></style:paragraph-properties><style:text-properties fo:color="#000000" style:text-outline="false" style:text-position="0% 100%" style:font-name="Helvetica" fo:font-size="9pt" fo:letter-spacing="normal" fo:font-style="italic" style:text-underline-style="none" style:letter-kerning="false" style:font-name-asian="Helvetica" style:font-size-asian="9pt" style:font-style-asian="italic" style:font-name-complex="Helvetica" style:font-size-complex="9pt" style:font-style-complex="italic"/></style:style><style:style style:name="P2" style:family="paragraph" style:parent-style-name="Footer"><style:paragraph-properties fo:text-align="end" style:justify-single-word="false"/></style:style><style:style style:name="P3" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P4" style:family="paragraph" style:parent-style-name="Title"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P5" style:family="paragraph" style:parent-style-name="Subtitle"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P6" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P7" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00135968" officeooo:paragraph-rsid="00135968"/></style:style><style:style style:name="P8" style:family="paragraph" style:parent-style-name="Heading_20_1"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P9" style:family="paragraph" style:parent-style-name="Heading_20_2"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P10" style:family="paragraph" style:parent-style-name="Heading_20_3"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:run-through="background" style:wrap="run-through" style:number-wrapped-paragraphs="no-limit" style:vertical-pos="from-top" style:vertical-rel="paragraph" style:horizontal-pos="from-left" style:horizontal-rel="paragraph" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls>';
fwrite($tempFile, $txt);


//echo "Genererar VB<br><br>";
//echo $lastYearPresentationText;

	$txt = "Verksamhetsberättelse för $orgName " . (date('Y')-1);
	$txt = odtTitleWrap($txt) . $odtTextNewlineHard . $odtTextNewlineHard . $odtTextNewlineHard . $odtTextNewlineHard . textToOdt($lastYearPresentationText);
	fwrite($tempFile, $txt);
	//echo $txt;	
	
	
	//Write end of XML
	fwrite($tempFile, $closeDocument);
	//Close file
	fclose($tempFile);
	
//Moves it into zip-archive
$zip = new ZipArchive;
if ($zip->open('templated.odt') === TRUE) {
	 //print_r($zip);
	 //echo "<br>";
    $zip->addFile('coolXML.txt', 'content.xml') or die('Fick inte flytta!');
    $zip->close();
    //echo 'ok';
} else {
    echo 'Något gick fel vid skapandet av ODT!';
}
//echo "<b>Wrote to zip!</b><br>";	
	
	
	//File Writing complete
	copy('templated.odt', $documentFilePaths['VB']);


	//Declare complete filename $filename_complete = "bilaga." . $attachmentID . "." . $attachmentNameFixed . "." . $documentNameTemplate . "." . $imageFileType;
	//$filename_complete = "bilaga." . $attachmentID . ".verksamhetsberattelse." . (date('Y')-1) . "." . $documentNameTemplate . ".odt";

}


if($generateDocumentsDocumentInfo['VP'] == "gen") 
{//Skriv verksamhetsplan

//Create TextFile because I fucking hate XML
$tempFile = fopen("coolXML.txt", "w") or die("Error creating file!");

//Put in Opening of file
$txt = '<?xml version="1.0" encoding="UTF-8"?>';
fwrite($tempFile, $txt);
//$txt = '<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="http://www.w3.org/TR/css3-text/" office:version="1.2">';
//fwrite($tempFile, $txt);
//$txt = '<office:scripts/><office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="Helvetica" svg:font-family="Helvetica" style:font-family-generic="swiss"/><style:font-face style:name="BorisBlackBloxx1" svg:font-family="BorisBlackBloxx" style:font-pitch="variable"/><style:font-face style:name="BorisBlackBloxx" svg:font-family="BorisBlackBloxx" style:font-adornments="Standard" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-adornments="Normal" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans1" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-adornments="Roman" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial Unicode MS" svg:font-family="&apos;Arial Unicode MS&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:paragraph-properties fo:text-align="justify" style:justify-single-word="false" style:text-autospace="none"><style:tab-stops><style:tab-stop style:position="16.99cm" style:type="right"/></style:tab-stops></style:paragraph-properties><style:text-properties fo:color="#000000" style:text-outline="false" style:text-position="0% 100%" style:font-name="Helvetica" fo:font-size="9pt" fo:letter-spacing="normal" fo:font-style="italic" style:text-underline-style="none" style:letter-kerning="false" style:font-name-asian="Helvetica" style:font-size-asian="9pt" style:font-style-asian="italic" style:font-name-complex="Helvetica" style:font-size-complex="9pt" style:font-style-complex="italic"/></style:style><style:style style:name="P2" style:family="paragraph" style:parent-style-name="Footer"><style:paragraph-properties fo:text-align="end" style:justify-single-word="false"/></style:style><style:style style:name="P3" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P4" style:family="paragraph" style:parent-style-name="Title"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P5" style:family="paragraph" style:parent-style-name="Subtitle"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P6" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P7" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00135968" officeooo:paragraph-rsid="00135968"/></style:style><style:style style:name="P8" style:family="paragraph" style:parent-style-name="Heading_20_1"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P9" style:family="paragraph" style:parent-style-name="Heading_20_2"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P10" style:family="paragraph" style:parent-style-name="Heading_20_3"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:run-through="background" style:wrap="run-through" style:number-wrapped-paragraphs="no-limit" style:vertical-pos="from-top" style:vertical-rel="paragraph" style:horizontal-pos="from-left" style:horizontal-rel="paragraph" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls>';
//fwrite($tempFile, $txt);
$txt = '<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="http://www.w3.org/TR/css3-text/" office:version="1.2"><office:scripts/><office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="Helvetica" svg:font-family="Helvetica" style:font-family-generic="swiss"/><style:font-face style:name="BorisBlackBloxx1" svg:font-family="BorisBlackBloxx" style:font-pitch="variable"/><style:font-face style:name="BorisBlackBloxx" svg:font-family="BorisBlackBloxx" style:font-adornments="Standard" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-adornments="Normal" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans1" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-adornments="Roman" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial Unicode MS" svg:font-family="&apos;Arial Unicode MS&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:paragraph-properties fo:text-align="justify" style:justify-single-word="false" style:text-autospace="none"><style:tab-stops><style:tab-stop style:position="16.99cm" style:type="right"/></style:tab-stops></style:paragraph-properties><style:text-properties fo:color="#000000" style:text-outline="false" style:text-position="0% 100%" style:font-name="Helvetica" fo:font-size="9pt" fo:letter-spacing="normal" fo:font-style="italic" style:text-underline-style="none" style:letter-kerning="false" style:font-name-asian="Helvetica" style:font-size-asian="9pt" style:font-style-asian="italic" style:font-name-complex="Helvetica" style:font-size-complex="9pt" style:font-style-complex="italic"/></style:style><style:style style:name="P2" style:family="paragraph" style:parent-style-name="Footer"><style:paragraph-properties fo:text-align="end" style:justify-single-word="false"/></style:style><style:style style:name="P3" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P4" style:family="paragraph" style:parent-style-name="Title"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P5" style:family="paragraph" style:parent-style-name="Subtitle"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P6" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P7" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00135968" officeooo:paragraph-rsid="00135968"/></style:style><style:style style:name="P8" style:family="paragraph" style:parent-style-name="Heading_20_1"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P9" style:family="paragraph" style:parent-style-name="Heading_20_2"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P10" style:family="paragraph" style:parent-style-name="Heading_20_3"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:run-through="background" style:wrap="run-through" style:number-wrapped-paragraphs="no-limit" style:vertical-pos="from-top" style:vertical-rel="paragraph" style:horizontal-pos="from-left" style:horizontal-rel="paragraph" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls>';
fwrite($tempFile, $txt);


	//echo "Genererar VP<br>";
	$txt = "Verksamhetsplan för $orgName " . date('Y');
	$txt = odtTitleWrap($txt) . $odtTextNewlineHard . $odtTextNewlineHard . $odtTextNewlineHard . $odtTextNewlineHard . textToOdt($nextYearPlanText);
	//echo htmlspecialchars($txt) . "<br><br><br>";
	fwrite($tempFile, $txt);
	//echo $txt;	
	
	
		//Write end of XML
	fwrite($tempFile, $closeDocument);
	//Close file
	fclose($tempFile);
	
//Moves it into zip-archive
$zip = new ZipArchive;
if ($zip->open('templated.odt') === TRUE) {
	 //print_r($zip);
	 //echo "<br>";
    $zip->addFile('coolXML.txt', 'content.xml') or die('Fick inte flytta!');
    $zip->close();
    //echo 'ok';
} else {
    echo 'Något gick fel vid skapandet av ODT!';
}
//echo "<b>Wrote to zip!</b><br>";	
	
	
	//File Writing complete
	copy('templated.odt', $documentFilePaths['VP']);



	//Declare complete filename $filename_complete = "bilaga." . $attachmentID . "." . $attachmentNameFixed . "." . $documentNameTemplate . "." . $imageFileType;
	//$filename_complete = "bilaga." . $attachmentID . ".verksamhetsplan." . date('Y') . "." . $documentNameTemplate . ".odt";

}


//Skriva protokoll

//Create TextFile because I fucking hate XML
$tempFile = fopen("coolXML.txt", "w") or die("Error creating file!");

//Put in Opening of file
$txt = '<?xml version="1.0" encoding="UTF-8"?>';
fwrite($tempFile, $txt);
//$txt = '<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="http://www.w3.org/TR/css3-text/" office:version="1.2">';
//fwrite($tempFile, $txt);
//$txt = '<office:scripts/><office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="Helvetica" svg:font-family="Helvetica" style:font-family-generic="swiss"/><style:font-face style:name="BorisBlackBloxx1" svg:font-family="BorisBlackBloxx" style:font-pitch="variable"/><style:font-face style:name="BorisBlackBloxx" svg:font-family="BorisBlackBloxx" style:font-adornments="Standard" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-adornments="Normal" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans1" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-adornments="Roman" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial Unicode MS" svg:font-family="&apos;Arial Unicode MS&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:paragraph-properties fo:text-align="justify" style:justify-single-word="false" style:text-autospace="none"><style:tab-stops><style:tab-stop style:position="16.99cm" style:type="right"/></style:tab-stops></style:paragraph-properties><style:text-properties fo:color="#000000" style:text-outline="false" style:text-position="0% 100%" style:font-name="Helvetica" fo:font-size="9pt" fo:letter-spacing="normal" fo:font-style="italic" style:text-underline-style="none" style:letter-kerning="false" style:font-name-asian="Helvetica" style:font-size-asian="9pt" style:font-style-asian="italic" style:font-name-complex="Helvetica" style:font-size-complex="9pt" style:font-style-complex="italic"/></style:style><style:style style:name="P2" style:family="paragraph" style:parent-style-name="Footer"><style:paragraph-properties fo:text-align="end" style:justify-single-word="false"/></style:style><style:style style:name="P3" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P4" style:family="paragraph" style:parent-style-name="Title"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P5" style:family="paragraph" style:parent-style-name="Subtitle"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P6" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P7" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00135968" officeooo:paragraph-rsid="00135968"/></style:style><style:style style:name="P8" style:family="paragraph" style:parent-style-name="Heading_20_1"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P9" style:family="paragraph" style:parent-style-name="Heading_20_2"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P10" style:family="paragraph" style:parent-style-name="Heading_20_3"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:run-through="background" style:wrap="run-through" style:number-wrapped-paragraphs="no-limit" style:vertical-pos="from-top" style:vertical-rel="paragraph" style:horizontal-pos="from-left" style:horizontal-rel="paragraph" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls>';
//fwrite($tempFile, $txt);
$txt = '<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="http://www.w3.org/TR/css3-text/" office:version="1.2"><office:scripts/><office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="Helvetica" svg:font-family="Helvetica" style:font-family-generic="swiss"/><style:font-face style:name="BorisBlackBloxx1" svg:font-family="BorisBlackBloxx" style:font-pitch="variable"/><style:font-face style:name="BorisBlackBloxx" svg:font-family="BorisBlackBloxx" style:font-adornments="Standard" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-adornments="Normal" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans1" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Bitstream Vera Sans" svg:font-family="&apos;Bitstream Vera Sans&apos;" style:font-adornments="Roman" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial Unicode MS" svg:font-family="&apos;Arial Unicode MS&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:paragraph-properties fo:text-align="justify" style:justify-single-word="false" style:text-autospace="none"><style:tab-stops><style:tab-stop style:position="16.99cm" style:type="right"/></style:tab-stops></style:paragraph-properties><style:text-properties fo:color="#000000" style:text-outline="false" style:text-position="0% 100%" style:font-name="Helvetica" fo:font-size="9pt" fo:letter-spacing="normal" fo:font-style="italic" style:text-underline-style="none" style:letter-kerning="false" style:font-name-asian="Helvetica" style:font-size-asian="9pt" style:font-style-asian="italic" style:font-name-complex="Helvetica" style:font-size-complex="9pt" style:font-style-complex="italic"/></style:style><style:style style:name="P2" style:family="paragraph" style:parent-style-name="Footer"><style:paragraph-properties fo:text-align="end" style:justify-single-word="false"/></style:style><style:style style:name="P3" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P4" style:family="paragraph" style:parent-style-name="Title"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P5" style:family="paragraph" style:parent-style-name="Subtitle"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P6" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P7" style:family="paragraph" style:parent-style-name="Text_20_body"><style:text-properties officeooo:rsid="00135968" officeooo:paragraph-rsid="00135968"/></style:style><style:style style:name="P8" style:family="paragraph" style:parent-style-name="Heading_20_1"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P9" style:family="paragraph" style:parent-style-name="Heading_20_2"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="P10" style:family="paragraph" style:parent-style-name="Heading_20_3"><style:text-properties officeooo:rsid="00122f5d" officeooo:paragraph-rsid="00122f5d"/></style:style><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:run-through="background" style:wrap="run-through" style:number-wrapped-paragraphs="no-limit" style:vertical-pos="from-top" style:vertical-rel="paragraph" style:horizontal-pos="from-left" style:horizontal-rel="paragraph" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls>';
fwrite($tempFile, $txt);


//Sanitize Array
//echo "Genererar Protokoll<br>";
foreach ($rawDataArray as $key => $value)
{
	if(trim($value) == "") //Credits to ceve who reminded me of trim()
	{
		unset($rawDataArray[$key]);
	}
	else 
	{
		$txt = textToOdt($value);
		//echo htmlspecialchars($txt) . "<br>";
		fwrite($tempFile, $txt);
	}
		
}


		//Write end of XML
	fwrite($tempFile, $closeDocument);
	//Close file
	fclose($tempFile);
	
//Moves it into zip-archive
$zip = new ZipArchive;
if ($zip->open('templated.odt') === TRUE) {
	 //print_r($zip);
	 //echo "<br>";
    $zip->addFile('coolXML.txt', 'content.xml') or die('Fick inte flytta!');
    $zip->close();
    //echo 'ok';
} else {
    echo 'Något gick fel vid skapandet av ODT!';
}
//echo "<b>Wrote to zip!</b><br>";	
	
	
	//File Writing complete
	copy('templated.odt', $documentFilePaths['Protokoll']);

//Cleanup
unset($txt);

//Rights
}
else 
{
	echo "No data in POST!";
}
?>